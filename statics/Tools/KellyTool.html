<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Kelly Bet Size Helper — CoffeeQuant Tools</title>
<link rel="stylesheet" href="../css/cq.css" />

<style>
  .tool-wrap {
    max-width: 700px;
    margin: 2rem auto;
    background: var(--panel-bg);
    border: 1px solid var(--panel-border);
    border-radius: var(--radius);
    box-shadow: var(--panel-shadow);
    padding: 1rem 1.25rem 2rem;
  }
  .tool-head {
    display:flex;
    flex-wrap:wrap;
    justify-content:space-between;
    align-items:flex-start;
    gap:1rem;
    margin-bottom:1rem;
  }
  .tool-head h1 {
    margin:0;
    font-size:1.2rem;
    line-height:1.3;
  }
  .tool-form {
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
    gap:0.75rem 1rem;
    margin-bottom:1rem;
  }
  .tool-form label {
    font-size:.8rem;
    color:var(--muted);
    display:block;
    margin-bottom:.25rem;
  }
  .tool-form input {
    width:100%;
    font-size:.9rem;
    padding:.5rem .6rem;
    border-radius:8px;
    border:1px solid var(--panel-border);
    background:var(--card-bg);
    color:var(--fg);
  }
  .tool-actions {
    display:flex;
    flex-wrap:wrap;
    gap:.5rem;
    margin-bottom:1rem;
  }
  .outbox {
    font-size:.85rem;
    line-height:1.5;
    background:var(--card-bg);
    border:1px solid var(--panel-border);
    border-radius:var(--radius);
    padding:1rem;
    white-space:pre-line;
  }
  a.cq-logo-mini {
    text-decoration:none;
    color:var(--fg);
    font-size:.8rem;
    font-weight:600;
  }
  .muted { color:var(--muted); font-size:.8rem; line-height:1.4;}
</style>
</head>
<body>

<div class="tool-wrap">
  <div class="tool-head">
    <div>
      <h1>Kelly Bet Size Helper</h1>
      <div class="cq-muted" style="font-size:.8rem;max-width:480px;">
        You think a bet has edge. How big do you go? This is the classic Kelly
        fraction plus the “half Kelly” that real desks actually live with.
      </div>
    </div>
    <div>
      <a class="cq-logo-mini" href="../../index.html">☕ CoffeeQuant Home →</a>
    </div>
  </div>

  <form class="tool-form" onsubmit="return false;">
    <div>
      <label>Win probability p (%)</label>
      <input id="k_p" type="number" step="0.1" value="55">
    </div>
    <div>
      <label>Win multiple W (e.g. +1.0 = you win +1x stake)</label>
      <input id="k_W" type="number" step="0.1" value="1.0">
    </div>
    <div>
      <label>Loss multiple L (e.g. 1.0 = you lose your stake)</label>
      <input id="k_L" type="number" step="0.1" value="1.0">
    </div>
    <div>
      <label>Your bankroll ($)</label>
      <input id="k_bank" type="number" step="1" value="10000">
    </div>
  </form>

  <div class="tool-actions">
    <button class="cq-btn" onclick="runKelly()">Compute</button>
    <button class="cq-btn-ghost" onclick="clearKelly()">Clear</button>
  </div>

  <div id="k_out" class="outbox">-- result will appear here --</div>

  <div class="muted" style="margin-top:1rem;">
    Model assumption: independent repeated bets and you care about long-run growth.
    Reality: you have path risk, career risk, liquidity, psychology. That’s why half Kelly exists.
  </div>
</div>

<script>
function runKelly(){
  const pPct = parseFloat(document.getElementById('k_p').value)||55;
  const W    = parseFloat(document.getElementById('k_W').value)||1.0;
  const L    = parseFloat(document.getElementById('k_L').value)||1.0;
  const bank = parseFloat(document.getElementById('k_bank').value)||10000;

  const p = pPct/100;
  const q = 1-p;

  // Kelly fraction for binary payoff:
  // f* = (p*W - q*L) / (W*L)
  const numer = p*W - q*L;
  const denom = W*L || 1e-9;
  let fstar = numer/denom;

  // clip for sanity: negative means don't bet
  if (fstar < 0) fstar = 0;

  const kellySize = fstar*bank;
  const halfSize  = 0.5*fstar*bank;
  const tenthSize = 0.1*fstar*bank;

  const msg =
`Inputs:
  Win prob p      = ${pPct.toFixed(2)}%
  Win multiple W  = +${W.toFixed(2)}× stake
  Loss multiple L = -${L.toFixed(2)}× stake
  Bankroll        = $${bank.toFixed(2)}

Kelly fraction f* (theory):
  ${ (fstar*100).toFixed(2) }% of bankroll per bet

Kelly $ per bet:
  Full Kelly  ~ $${kellySize.toFixed(2)}
  Half Kelly  ~ $${halfSize.toFixed(2)}
  Tenth Kelly ~ $${tenthSize.toFixed(2)}

Desk intuition:
- Full Kelly maximizes long-run growth but is very swingy.
- Half Kelly is what many serious desks use.
- If you emotionally can't handle drawdowns, even 1/10 Kelly might be your real size.

If f* is 0%, that means ‘No, you don't actually have edge here.’`;

  document.getElementById('k_out').textContent = msg;
}

function clearKelly(){
  document.getElementById('k_out').textContent = "-- result will appear here --";
}
</script>

</body>
</html>

